@model FlightSearchEngine.Models.SearchViewModel
@{
    ViewData["Title"] = "Search Flights";
}

<div class="row justify-content-center mt-5">
    <div class="col-md-8">
        <div class="card shadow-sm">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0">✈️ Flight Search Engine</h4>
            </div>
            <div class="card-body bg-light">
                <form method="post" id="searchForm" asp-controller="Flight" asp-action="SearchFlights">
                    @Html.AntiForgeryToken()
                    
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label asp-for="Source" class="form-label fw-bold">Source</label>
                            <select asp-for="Source" asp-items="Model.SourceList" class="form-select" id="sourceSelect">
                                <option value="">-- Select Source --</option>
                            </select>
                            <span asp-validation-for="Source" class="text-danger"></span>
                        </div>
                        <div class="col-md-6">
                            <label asp-for="Destination" class="form-label fw-bold">Destination</label>
                            <select asp-for="Destination" asp-items="Model.DestinationList" class="form-select" id="destSelect">
                                <option value="">-- Select Destination --</option>
                            </select>
                            <span asp-validation-for="Destination" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="row mb-4">
                        <div class="col-md-6">
                            <label asp-for="NumberOfPersons" class="form-label fw-bold">Number of Persons</label>
                            <input asp-for="NumberOfPersons" class="form-control" type="number" min="1" max="10" value="1" />
                            <span asp-validation-for="NumberOfPersons" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                        <button type="submit" class="btn btn-success px-4 py-2 me-md-2" id="btnFlightOnly" onclick="document.getElementById('searchForm').action='@Url.Action("SearchFlights", "Flight")'">
                            Search Flights Only
                        </button>
                        <button type="submit" class="btn btn-warning px-4 py-2" id="btnFlightHotel" onclick="document.getElementById('searchForm').action='@Url.Action("SearchFlightsWithHotels", "Flight")'">
                            Search Flight + Hotel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}

    <script>
        $(document).ready(function () {
            // Prevent selecting same source and destination
            $('#sourceSelect').change(function () {
                var selectedSource = $(this).val();
                $('#destSelect option').prop('disabled', false);
                if (selectedSource) {
                    $('#destSelect option[value="' + selectedSource + '"]').prop('disabled', true);
                }
            });

            $('#destSelect').change(function () {
                var selectedDest = $(this).val();
                $('#sourceSelect option').prop('disabled', false);
                if (selectedDest) {
                    $('#sourceSelect option[value="' + selectedDest + '"]').prop('disabled', true);
                }
            });
        });
    </script>
}
